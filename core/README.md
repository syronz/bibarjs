The core of the framework, do not edit
